      <center>
          <h1>Player (MP4SEG)</h1>
          <video height="600" id="video" controls preload></video>
      </center>
      <script>
	    function playEasy(qs) {
		    var video = document.getElementById('video');
		    video.src = qs;
		  video.addEventListener('canplaythrough',function() {		   
		      video.play();		  
		  });
		}
		
		function pad(n, width, z) {
		    z = z || '0';
            n = n + '';
            return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;
        }
		
		
		function playSeg(qs, path) {
		    var video = document.getElementById('video');		    
		    var mediaSource = new MediaSource();
		    video.src = window.URL.createObjectURL(mediaSource);
			mediaSource.addEventListener('sourceopen', function() { 
			     var supported = MediaSource.isTypeSupported('video/mp4; codecs="avc1.640029,mp4a.40.2"');
				 console.log("mime supported: " + supported);
			     var sourceBuffer = mediaSource.addSourceBuffer('video/mp4; codecs="avc1.640029,mp4a.40.2"');
				 path = path.replace('../video/', '');
				 path = path.replace(/\.[^/.]+$/, "");
				 path = 'tmp/' + path;				
				 function addSegment(tpath, counter) {
				     get(tpath + pad(counter, 3) + '.mp4', function(uInt8Array) {					      
						  var file = new Blob([uInt8Array], {
                              type: 'video/mp4'
                          });
                          var reader = new FileReader();
                          reader.onload = function(e) {
                              sourceBuffer.appendBuffer(new Uint8Array(e.target.result));
							  //mediaSource.endOfStream();
							  //video.play();
							  //addSegment(tpath, counter + 1);
                          }   
                          reader.readAsArrayBuffer(file);    
				          //sourceBuffer.appendBuffer(uInt8Array);
						  //addSegment(tpath, counter + 1);
				      });				 
				 }
				 
				 sourceBuffer.addEventListener('updateend', function(e) {
        console.log('Finished updating buffer');
        console.log('New duration is ' + String(mediaSource.duration));

       
            mediaSource.endOfStream();
            video.currentTime = 0;
            video.play();           
        
		});
				 //get  m3u8
				 console.log('path ' + path);
				 get(qs, function(arg){
                     addSegment(path, 0);				 
				 });
				 
                				 
			});
			
		}
        function _SetVideo(path){
		    var queryString = "get_video?name=" + path + "&fmt=mp4seg";
			//playEasy(queryString);
			playSeg(queryString, path);
			
		}
		
		function get(url, callback) {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.responseType = 'arraybuffer';
            xhr.send(); 
            xhr.onload = function() {
            if ((xhr.status !== 200)) {
              alert('Unexpected status code ' + xhr.status + ' for ' + url);
              return false;
            }
            callback(new Uint8Array(xhr.response));	
          };
       }



    
      
      
      </script>
	  
